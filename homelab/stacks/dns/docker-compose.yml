version: "3.9"

services:
  pihole:
    image: pihole/pihole:latest
    container_name: pihole
    network_mode: "host"   # Host networking binds directly to the VM IP
    restart: unless-stopped
    environment:
      TZ: ${TZ:-America/New_York}
      WEBPASSWORD: ${PIHOLE_PASSWORD:-changeme}
      DNS1: ${PIHOLE_DNS1:-1.1.1.1}
      DNS2: ${PIHOLE_DNS2:-1.0.0.1}
      # ServerIP is not needed with host mode
    volumes:
      - "${BASE_PATH}/config/pihole/etc-pihole:/etc/pihole"
      - "${BASE_PATH}/config/pihole/etc-dnsmasq.d:/etc/dnsmasq.d"
      - "${BASE_PATH}/config/pihole/logs:/var/log/pihole"
    # Remove the networks section entirely
    labels:
      - "traefik.enable=false"
